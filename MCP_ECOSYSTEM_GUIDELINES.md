# MCP Ecosystem Guidelines
# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ MCP —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã—Ö AI –∞–≥–µ–Ω—Ç–æ–≤

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 7 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –î–µ–π—Å—Ç–≤—É—é—â–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã)
3. [–°—Ç–∞–Ω–¥–∞—Ä—Ç MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤](#—Å—Ç–∞–Ω–¥–∞—Ä—Ç-mcp-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤)
4. [–ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](#–ø—Ä–∏–Ω—Ü–∏–ø—ã-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
5. [–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è](#—Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è)
6. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
7. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
8. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
9. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
10. [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
11. [–°–ø–µ—Ü–∏—Ñ–∏–∫–∞ AI –∞–≥–µ–Ω—Ç–æ–≤](#—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞-ai-–∞–≥–µ–Ω—Ç–æ–≤)
12. [–°–ø–µ—Ü–∏—Ñ–∏–∫–∞ MCP —Å–µ—Ä–≤–µ—Ä–æ–≤](#—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞-mcp-—Å–µ—Ä–≤–µ—Ä–æ–≤)
13. [–®–∞–±–ª–æ–Ω—ã –∏ –ø—Ä–∏–º–µ—Ä—ã](#—à–∞–±–ª–æ–Ω—ã-–∏-–ø—Ä–∏–º–µ—Ä—ã)

---

## –í–≤–µ–¥–µ–Ω–∏–µ

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã

–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ MCP (Model Context Protocol) ‚Äî —ç—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã—Ö AI –∞–≥–µ–Ω—Ç–æ–≤, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è –¥–ª—è:

- **–¢–æ—Ä–≥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑**: –ê–Ω–∞–ª–∏–∑ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞ (TradingView MCP)
- **–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ (Binance MCP)
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π**: –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (Backtesting MCP)
- **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞**: –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ (Shell MCP)
- **–ü–∞–º—è—Ç—å –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç**: –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (Memory MCP)
- **–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã**: –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã –¥–ª—è Telegram (HALv1)

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
mcp/
‚îú‚îÄ‚îÄ servers/                    # MCP —Å–µ—Ä–≤–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ backtesting-mcp/       # –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ binance-mcp/           # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Binance API
‚îÇ   ‚îú‚îÄ‚îÄ learning-mcp/         # –°–∏—Å—Ç–µ–º–∞ –æ–±—É—á–µ–Ω–∏—è –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ memory-mcp/            # –°–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏ –∏ –ø–æ–∏—Å–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ shell-mcp/             # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –≤ Docker
‚îÇ   ‚îú‚îÄ‚îÄ supervisor-mcp/        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ tradingview-mcp/       # –ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ —á–µ—Ä–µ–∑ TradingView
‚îú‚îÄ‚îÄ infra/                      # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ postgres/              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ templates/             # –®–∞–±–ª–æ–Ω—ã –¥–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ tests/                 # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ wheels/                # Python wheels –¥–ª—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ impl_plan/                  # –ü–ª–∞–Ω—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ HAL –∞–≥–µ–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ hal_ai_agent_plan.md
‚îÇ   ‚îú‚îÄ‚îÄ hal_autonomous_agent_overview.md
‚îÇ   ‚îú‚îÄ‚îÄ hal_extras_addendum.md
‚îÇ   ‚îú‚îÄ‚îÄ HAL_IMPLEMENTATION_CHECKLIST.md
‚îÇ   ‚îî‚îÄ‚îÄ hal_implementation_instructions.md
‚îú‚îÄ‚îÄ halv1/                     # –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π AI –∞–≥–µ–Ω—Ç –¥–ª—è Telegram
‚îú‚îÄ‚îÄ config/                    # –û–±—â–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ mcp-web-ui/                # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è MCP
```

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

- **MCP —Å–µ—Ä–≤–µ—Ä—ã** –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ Model Context Protocol
- **AI –∞–≥–µ–Ω—Ç—ã** –∏—Å–ø–æ–ª—å–∑—É—é—Ç MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
- **–û–±—â–∞—è –ø–∞–º—è—Ç—å** (Memory MCP) –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –∏—Å—Ç–æ—Ä–∏—é
- **Docker Compose** –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. Model Context Protocol (MCP)

**MCP** ‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É AI –∞–≥–µ–Ω—Ç–∞–º–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:
- **Tools**: –§—É–Ω–∫—Ü–∏–∏, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞–≥–µ–Ω—Ç–∞–º
- **Resources**: –î–∞–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç
- **Prompts**: –®–∞–±–ª–æ–Ω—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- **Transports**: stdio, HTTP, WebSocket

### 2. FastMCP –∫–∞–∫ –±–∞–∑–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫

–í—Å–µ MCP —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç **FastMCP** ‚Äî Python-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ MCP —Å–µ—Ä–≤–µ—Ä–æ–≤.

```python
from fastmcp import FastMCP

mcp = FastMCP("server-name")

@mcp.tool()
def example_tool(param: str) -> dict:
    """Short description (‚â§90 chars) starting with a verb."""
    # Implementation
    return {"result": "value"}
```

### 3. –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ MCP —Å–µ—Ä–≤–µ—Ä–∞:**

```
project-mcp/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ project_mcp/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ       ‚îú‚îÄ‚îÄ server.py            # MCP —Å–µ—Ä–≤–µ—Ä
‚îÇ       ‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Pydantic Settings)
‚îÇ       ‚îú‚îÄ‚îÄ services/            # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ core_service.py
‚îÇ       ‚îî‚îÄ‚îÄ tools/               # MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
‚îÇ           ‚îú‚îÄ‚îÄ __init__.py
‚îÇ           ‚îú‚îÄ‚îÄ models.py        # Pydantic –º–æ–¥–µ–ª–∏
‚îÇ           ‚îî‚îÄ‚îÄ tool_handlers.py
‚îú‚îÄ‚îÄ tests/                       # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ examples/                    # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ docs/                        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ pyproject.toml              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ AGENTS.md                   # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
‚îî‚îÄ‚îÄ CHANGELOG.md                # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

### 4. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

**–ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

- `server.py` ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ FastMCP, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- `config.py` ‚Äî –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–µ—Ä–µ–∑ Pydantic Settings
- `services/` ‚Äî –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Ç MCP
- `tools/` ‚Äî MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —Ç–æ–Ω–∫–∞—è –æ–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- `models.py` ‚Äî Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–º–µ—Ä –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**

```
–ê–≥–µ–Ω—Ç ‚Üí MCP Tool ‚Üí Service Layer ‚Üí External API/Database
       ‚Üì
    Validation (Pydantic)
       ‚Üì
    Business Logic
       ‚Üì
    Response ‚Üí –ê–≥–µ–Ω—Ç
```

### 5. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–≤

**Stdio —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç** (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏):
```bash
python -m project_mcp.server --stdio
```

**HTTP —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç** (–¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã):
```bash
python -m project_mcp.server --host 0.0.0.0 --port 8000
```

**Docker Compose:**
```yaml
services:
  project-mcp:
    build: ./project-mcp
    ports:
      - "8000:8000"
    environment:
      - PROJECT_API_KEY=${API_KEY}
```

---

## –°—Ç–∞–Ω–¥–∞—Ä—Ç MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### 1. –§–æ—Ä–º–∞—Ç –æ–ø–∏—Å–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

‚úÖ **–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ ‚â§90 —Å–∏–º–≤–æ–ª–æ–≤**  
‚úÖ **–ì–ª–∞–≥–æ–ª –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º –≤—Ä–µ–º–µ–Ω–∏** (Executes, Returns, Fetches, Analyzes)  
‚úÖ **–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫** (–¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è –≤ list_tools)  
‚úÖ **–î–µ—Ç–∞–ª–∏ –≤–æ –≤—Ç–æ—Ä–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏** –∏–ª–∏ docstring

**–ü—Ä–∏–º–µ—Ä—ã:**

‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û:**
```python
@mcp.tool()
def run_backtest(symbol: str, strategy: str) -> dict:
    """Runs a backtest of trading strategy on historical market data."""
    # Implementation
```

‚ùå **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:**
```python
@mcp.tool()
def run_backtest(symbol: str, strategy: str) -> dict:
    """–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç –±—ç–∫—Ç–µ—Å—Ç —Ç–æ—Ä–≥–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–∫–ª—é—á–∞—è Sharpe ratio –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ—Å–∞–¥–∫—É."""
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤

**–ë–∞–∑–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:**
```python
@mcp.tool()
def tool_name(param: str) -> dict:
    """Description."""
    return {"status": "success"}
```

**–° –∫–∞—Å—Ç–æ–º–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º:**
```python
@mcp.tool(description="Custom short description")
def tool_name(param: str) -> dict:
    """Extended documentation here."""
    return {"status": "success"}
```

**–° –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º:**
```python
@mcp.tool()
@log_tool  # –ö–∞—Å—Ç–æ–º–Ω—ã–π –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
def tool_name(param: str) -> dict:
    """Description."""
    return {"status": "success"}
```

### 3. Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π:**
```python
from pydantic import BaseModel, Field

class BacktestRequest(BaseModel):
    """Request model for backtesting."""
    symbol: str = Field(..., description="Trading symbol (e.g., BTCUSDT)")
    strategy: str = Field(..., description="Strategy name")
    start: str = Field(default="2025-01-01T00:00:00", description="Start date (ISO8601)")
    end: str = Field(default="2025-12-31T23:59:59", description="End date (ISO8601)")
    parameters: dict = Field(default_factory=dict, description="Strategy parameters")

class BacktestResult(BaseModel):
    """Result model for backtesting."""
    strategy: str
    symbol: str
    metrics: dict
    equity_curve: list[float]
    trade_log: list[dict]
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö:**
```python
@mcp.tool()
def run_backtest(request: BacktestRequest) -> BacktestResult:
    """Runs a backtest of trading strategy on historical market data."""
    # –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    result = backtesting_service.execute(request)
    return BacktestResult(**result)
```

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**Best practices:**

1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ vs –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**
   - –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è —á–µ—Ä–µ–∑ `Field(...)`
   - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å `Field(default=...)`

2. **–í–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**
   ```python
   # –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ: code XOR script_path (–æ–¥–∏–Ω –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)
   code: str | None = Field(default=None)
   script_path: str | None = Field(default=None)
   ```

3. **–§–æ—Ä–º–∞—Ç —Å–ª–æ–∂–Ω—ã—Ö –ø–æ–ª–µ–π**
   ```python
   env: list[str] = Field(
       default_factory=list,
       description="Environment variables as KEY=VALUE strings",
       examples=[["API_KEY=secret", "DEBUG=true"]]
   )
   ```

4. **–î–∏–∞–ø–∞–∑–æ–Ω—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**
   ```python
   limit: int = Field(
       default=50,
       ge=1,
       le=200,
       description="Maximum number of results (1-200)"
   )
   ```

### 5. –ü—Ä–∏–º–µ—Ä—ã –≤—ã–∑–æ–≤–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

**–í–∫–ª—é—á–∞–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤ docstring:**

```python
@mcp.tool()
def coin_analysis(symbol: str, exchange: str = "KUCOIN") -> dict:
    """Analyzes a specific cryptocurrency with technical indicators.
    
    Examples:
        >>> coin_analysis(symbol="BTCUSDT", exchange="KUCOIN")
        >>> coin_analysis(symbol="ETHUSDT", exchange="BINANCE")
    
    Args:
        symbol: Trading pair (e.g., BTCUSDT, ETHUSDT)
        exchange: Exchange name (KUCOIN, BINANCE, etc.)
    
    Returns:
        Analysis with RSI, MACD, Bollinger Bands and trading signals
    """
    return analyzer.analyze(symbol, exchange)
```

---

## –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 1. –¢–∏–ø–∏–∑–∞—Ü–∏—è

**–°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π:**

```python
from typing import Any, Literal

def process_data(
    input_data: list[dict[str, Any]],
    mode: Literal["fast", "accurate"] = "fast",
    timeout: float = 30.0
) -> dict[str, Any]:
    """Process data with specified mode."""
    ...
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Pydantic:**
```python
from pydantic import BaseModel, validator

class Config(BaseModel):
    api_key: str
    timeout: float = 30.0
    max_retries: int = 3
    
    @validator("timeout")
    def validate_timeout(cls, v):
        if v <= 0:
            raise ValueError("timeout must be positive")
        return v
```

### 2. –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**

- **Dependency Inversion**: Services –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π, –Ω–µ –æ—Ç –¥–µ—Ç–∞–ª–µ–π
- **Single Responsibility**: –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –∏–º–µ–µ—Ç –æ–¥–Ω—É –ø—Ä–∏—á–∏–Ω—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **Interface Segregation**: –ö–ª–∏–µ–Ω—Ç—ã –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤

**–ü—Ä–∏–º–µ—Ä:**

```python
# services/base.py
from abc import ABC, abstractmethod

class MarketDataProvider(ABC):
    @abstractmethod
    async def get_candles(self, symbol: str, interval: str) -> list[dict]:
        pass

# services/binance_provider.py
class BinanceProvider(MarketDataProvider):
    async def get_candles(self, symbol: str, interval: str) -> list[dict]:
        # Implementation
        pass

# services/backtesting.py
class BacktestingService:
    def __init__(self, data_provider: MarketDataProvider):
        self.provider = data_provider
    
    async def run(self, symbol: str):
        candles = await self.provider.get_candles(symbol, "1h")
        # Backtest logic
```

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ ENV

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Pydantic Settings:**

```python
from pydantic_settings import BaseSettings, SettingsConfigDict

class Settings(BaseSettings):
    model_config = SettingsConfigDict(
        env_prefix="PROJECT_",  # –ü—Ä–µ—Ñ–∏–∫—Å –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
        env_file=".env",
        case_sensitive=False
    )
    
    api_key: str
    api_secret: str
    default_timeout: float = 30.0
    max_retries: int = 3
    debug: bool = False

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
settings = Settings()
```

**–ü—Ä–µ—Ñ–∏–∫—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:**
- `BACKTEST_` ‚Äî Backtesting MCP
- `BINANCE_` ‚Äî Binance MCP
- `TRADINGVIEW_` ‚Äî TradingView MCP
- `SHELL_MCP_` ‚Äî Shell MCP
- `MEMORY_` ‚Äî Memory MCP

### 4. SOLID, DRY, KISS, YAGNI

**SOLID:**
- **S**ingle Responsibility: –û–¥–∏–Ω –∫–ª–∞—Å—Å = –æ–¥–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
- **O**pen/Closed: –û—Ç–∫—Ä—ã—Ç –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, –∑–∞–∫—Ä—ã—Ç –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **L**iskov Substitution: –ü–æ–¥–∫–ª–∞—Å—Å—ã –∑–∞–º–µ–Ω—è–µ–º—ã –±–∞–∑–æ–≤—ã–º–∏ –∫–ª–∞—Å—Å–∞–º–∏
- **I**nterface Segregation: –ú–Ω–æ–≥–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- **D**ependency Inversion: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π

**DRY** (Don't Repeat Yourself):
```python
# ‚ùå –ü–ª–æ—Ö–æ
def get_btc_price(): ...
def get_eth_price(): ...
def get_xrp_price(): ...

# ‚úÖ –•–æ—Ä–æ—à–æ
def get_price(symbol: str): ...
```

**KISS** (Keep It Simple, Stupid):
```python
# ‚ùå –°–ª–æ–∂–Ω–æ
result = [x for x in data if condition(x)] if data else []

# ‚úÖ –ü—Ä–æ—Å—Ç–æ
if not data:
    return []
return [x for x in data if condition(x)]
```

**YAGNI** (You Aren't Gonna Need It):
- –ù–µ –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å "–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π"
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ —Å–µ–π—á–∞—Å

### 5. Graceful Error Handling

**–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**

```python
from typing import Any
import logging

logger = logging.getLogger(__name__)

@mcp.tool()
def risky_operation(param: str) -> dict[str, Any]:
    """Performs a risky operation with proper error handling."""
    try:
        result = perform_operation(param)
        return {
            "success": True,
            "data": result
        }
    except ValidationError as e:
        logger.warning(f"Validation error: {e}")
        return {
            "success": False,
            "error": "invalid_input",
            "message": str(e)
        }
    except ExternalAPIError as e:
        logger.error(f"API error: {e}")
        return {
            "success": False,
            "error": "api_error",
            "message": "External service unavailable"
        }
    except Exception as e:
        logger.exception(f"Unexpected error: {e}")
        return {
            "success": False,
            "error": "internal_error",
            "message": "An unexpected error occurred"
        }
```

---

## –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. PEP 8

–°–ª–µ–¥—É–π—Ç–µ [PEP 8](https://peps.python.org/pep-0008/) ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É Python.

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:**
- –û—Ç—Å—Ç—É–ø—ã: 4 –ø—Ä–æ–±–µ–ª–∞
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏: 88 —Å–∏–º–≤–æ–ª–æ–≤ (Black)
- –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ: `snake_case` –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π/–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, `PascalCase` –¥–ª—è –∫–ª–∞—Å—Å–æ–≤
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã: `UPPER_CASE`
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã: `_private_method`

### 2. Black (88 —Å–∏–º–≤–æ–ª–æ–≤)

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

```bash
# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
black .

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
black --check .

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ pyproject.toml
[tool.black]
line-length = 88
target-version = ['py311']
include = '\.pyi?$'
```

### 3. Ruff –ª–∏–Ω—Ç–∏–Ω–≥

**–ë—ã—Å—Ç—Ä—ã–π –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ª–∏–Ω—Ç–µ—Ä:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
ruff check .

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
ruff check --fix .

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ pyproject.toml
[tool.ruff]
line-length = 88
select = ["E", "F", "I", "N", "W"]
ignore = []
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:**
- `E` ‚Äî PEP 8 –æ—à–∏–±–∫–∏
- `F` ‚Äî –û—à–∏–±–∫–∏ pyflakes
- `I` ‚Äî –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤ (isort)
- `N` ‚Äî –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ (pep8-naming)
- `W` ‚Äî –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### 4. MyPy (strict mode)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
mypy src/

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ pyproject.toml
[tool.mypy]
python_version = "3.11"
strict = true
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true
```

**–ü—Ä–∏–º–µ—Ä—ã:**

```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
def calculate(value: float) -> float:
    return value * 2

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ç–∏–ø—ã)
def calculate(value):
    return value * 2
```

### 5. Conventional Commits

**–§–æ—Ä–º–∞—Ç –∫–æ–º–º–∏—Ç–∞:**

```
<type>(<scope>): <subject>

<body>

<footer>
```

**–¢–∏–ø—ã:**
- `feat:` ‚Äî –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- `fix:` ‚Äî –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏
- `docs:` ‚Äî –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- `test:` ‚Äî –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
- `refactor:` ‚Äî –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–∞
- `perf:` ‚Äî –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- `style:` ‚Äî –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏)
- `chore:` ‚Äî –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–æ–Ω—Ñ–∏–≥)

**–î–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤:**
- `ai:` ‚Äî –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏–∫–µ –∞–≥–µ–Ω—Ç–∞
- `memory:` ‚Äî –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ –ø–∞–º—è—Ç–∏

**–î–ª—è MCP —Å–µ—Ä–≤–µ—Ä–æ–≤:**
- `security:` ‚Äî –ò–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `analytics:` ‚Äî –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ

**–ü—Ä–∏–º–µ—Ä—ã:**

```bash
feat(indicators): –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä ADX
fix(screener): –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç Bollinger Bands
docs(api): –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º
test(executor): –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è Docker –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
refactor(llm): —É–ø—Ä–æ—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å LLM –∫–ª–∏–µ–Ω—Ç–æ–≤
perf(api): –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞—Ç—á–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ TradingView
security(docker): —É–∂–µ—Å—Ç–æ—á–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
ai(planning): —É–ª—É—á—à–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á
memory(graph): —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–æ–≤—É—é –ø–∞–º—è—Ç—å
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. Unit —Ç–µ—Å—Ç—ã (80%+ –ø–æ–∫—Ä—ã—Ç–∏–µ)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤:**

```
tests/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ conftest.py              # –§–∏–∫—Å—Ç—É—Ä—ã pytest
‚îú‚îÄ‚îÄ test_services/
‚îÇ   ‚îú‚îÄ‚îÄ test_backtesting.py
‚îÇ   ‚îî‚îÄ‚îÄ test_indicators.py
‚îú‚îÄ‚îÄ test_tools/
‚îÇ   ‚îî‚îÄ‚îÄ test_mcp_tools.py
‚îî‚îÄ‚îÄ test_integration/
    ‚îî‚îÄ‚îÄ test_end_to_end.py
```

**–ü—Ä–∏–º–µ—Ä unit —Ç–µ—Å—Ç–∞:**

```python
import pytest
from project_mcp.services import BacktestingService

@pytest.fixture
def service():
    return BacktestingService()

def test_backtest_calculates_metrics(service):
    """Test that backtest calculates all required metrics."""
    result = service.run(
        symbol="BTCUSDT",
        strategy="ma_crossover",
        parameters={"fast": 10, "slow": 20}
    )
    
    assert "total_return" in result.metrics
    assert "sharpe" in result.metrics
    assert "max_drawdown" in result.metrics
    assert result.metrics["trades"] > 0

def test_backtest_handles_invalid_symbol(service):
    """Test that backtest handles invalid symbols gracefully."""
    with pytest.raises(ValueError, match="Invalid symbol"):
        service.run(symbol="INVALID", strategy="ma_crossover")
```

**–¶–µ–ª—å: –º–∏–Ω–∏–º—É–º 80% –ø–æ–∫—Ä—ã—Ç–∏–µ:**

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest tests/ --cov=src --cov-report=html --cov-report=term

# –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–∞
open htmlcov/index.html
```

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**

```python
import pytest
from fastmcp.testing import MCPTestClient

@pytest.mark.integration
async def test_backtest_tool_integration():
    """Test full backtest flow through MCP tool."""
    async with MCPTestClient(mcp) as client:
        response = await client.call_tool(
            "run_backtest",
            {
                "symbol": "BTCUSDT",
                "strategy": "ma_crossover",
                "parameters": {"fast": 10, "slow": 20}
            }
        )
        
        assert response["success"] is True
        assert "metrics" in response["data"]
        assert response["data"]["metrics"]["total_return"] != 0
```

### 3. Mock –æ–±—ä–µ–∫—Ç—ã

**–ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**

```python
from unittest.mock import Mock, patch
import pytest

@pytest.fixture
def mock_binance_client():
    """Mock Binance API client."""
    client = Mock()
    client.get_klines.return_value = [
        [1609459200000, "29000", "30000", "28000", "29500", "1000"],
        # ... more data
    ]
    return client

def test_backtest_with_mocked_data(mock_binance_client):
    """Test backtest with mocked market data."""
    with patch("project_mcp.services.BinanceClient", return_value=mock_binance_client):
        service = BacktestingService()
        result = service.run("BTCUSDT", "ma_crossover")
        
        assert result is not None
        mock_binance_client.get_klines.assert_called_once()
```

### 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

**–ü–∞—Ç—Ç–µ—Ä–Ω AAA (Arrange-Act-Assert):**

```python
def test_indicator_calculation():
    # Arrange: –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    prices = [100, 102, 101, 103, 105]
    period = 3
    
    # Act: –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
    result = calculate_sma(prices, period)
    
    # Assert: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    assert len(result) == len(prices) - period + 1
    assert result[0] == pytest.approx(101.0)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:**

```python
@pytest.mark.parametrize("symbol,expected_exchange", [
    ("BTCUSDT", "BINANCE"),
    ("BTC-USDT", "KUCOIN"),
    ("BTC/USDT", "GENERAL"),
])
def test_symbol_parsing(symbol, expected_exchange):
    """Test symbol parsing for different exchanges."""
    result = parse_symbol(symbol)
    assert result.exchange == expected_exchange
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ .env —Ñ–∞–π–ª–∞:**

```bash
# Binance MCP
BINANCE_API_KEY=your_api_key
BINANCE_API_SECRET=your_api_secret
BINANCE_DEMO_TRADING=false

# TradingView MCP
TRADINGVIEW_API_KEY=your_api_key
DEFAULT_EXCHANGE=KUCOIN
DEFAULT_TIMEFRAME=15m

# Backtesting MCP
BACKTEST_PREFERRED_SOURCE=binance
BACKTEST_DEFAULT_TIMEFRAME=1h

# Shell MCP
SHELL_MCP_DEFAULT_IMAGE=python:3.11
SHELL_MCP_TIMEOUT_SECONDS=120
SHELL_MCP_MAX_CONTAINERS=10

# Memory MCP
MEMORY_DB_PATH=/data/memory_graph.db
QDRANT_URL=http://qdrant:6333
EMBEDDINGS_URL=http://embeddings:80

# –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
LOG_LEVEL=INFO
DEBUG=false
```

### 2. –ü—Ä–µ—Ñ–∏–∫—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã:**

| –°–µ—Ä–≤–∏—Å | –ü—Ä–µ—Ñ–∏–∫—Å | –ü—Ä–∏–º–µ—Ä—ã |
|--------|---------|---------|
| Backtesting MCP | `BACKTEST_` | `BACKTEST_DEFAULT_TIMEFRAME` |
| Binance MCP | `BINANCE_` | `BINANCE_API_KEY` |
| TradingView MCP | `TRADINGVIEW_` | `TRADINGVIEW_API_KEY` |
| Shell MCP | `SHELL_MCP_` | `SHELL_MCP_DEFAULT_IMAGE` |
| Memory MCP | `MEMORY_` | `MEMORY_DB_PATH` |

**–ò–∑–±–µ–≥–∞–π—Ç–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.

### 3. Pydantic Settings

**–ë–∞–∑–æ–≤—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω:**

```python
from pydantic_settings import BaseSettings, SettingsConfigDict
from functools import lru_cache

class ServiceSettings(BaseSettings):
    model_config = SettingsConfigDict(
        env_prefix="SERVICE_",
        env_file=".env",
        env_file_encoding="utf-8",
        case_sensitive=False,
        extra="ignore"
    )
    
    # API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    api_key: str
    api_secret: str
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    default_timeout: float = 30.0
    max_retries: int = 3
    
    # –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
    debug: bool = False
    demo_mode: bool = False

@lru_cache()
def get_settings() -> ServiceSettings:
    """Get cached settings instance."""
    return ServiceSettings()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
settings = get_settings()
```

### 4. Docker Compose –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–ü—Ä–∏–º–µ—Ä docker-compose.yml:**

```yaml
version: '3.8'

services:
  binance-mcp:
    build: ./servers/binance-mcp
    ports:
      - "8000:8000"
    environment:
      - BINANCE_API_KEY=${BINANCE_API_KEY}
      - BINANCE_API_SECRET=${BINANCE_API_SECRET}
    env_file:
      - .env
    restart: unless-stopped

  tradingview-mcp:
    build: ./servers/tradingview-mcp
    ports:
      - "8060:8060"
    environment:
      - TRADINGVIEW_API_KEY=${TRADINGVIEW_API_KEY}
      - DEFAULT_EXCHANGE=KUCOIN
    depends_on:
      - postgres
    restart: unless-stopped

  backtesting-mcp:
    build: ./servers/backtesting-mcp
    ports:
      - "8082:8082"
    environment:
      - BACKTEST_BINANCE_URL=http://binance-mcp:8000
      - BACKTEST_TRADINGVIEW_URL=http://tradingview-mcp:8060
    depends_on:
      - binance-mcp
      - tradingview-mcp
    restart: unless-stopped

  shell-mcp:
    build: ./servers/shell-mcp
    ports:
      - "8070:8070"
    environment:
      - SHELL_MCP_DEBUG=false
    restart: unless-stopped

  memory-mcp:
    build: ./servers/memory-mcp
    ports:
      - "8050:8050"
    environment:
      - MEMORY_MCP_DEBUG=false
    depends_on:
      - redis
    restart: unless-stopped

  supervisor-mcp:
    build: ./servers/supervisor-mcp
    ports:
      - "8001:8001"
    environment:
      - SUPERVISOR_MCP_DEBUG=false
    restart: unless-stopped

  bright-data-mcp:
    image: node:18-alpine
    ports:
      - "8083:8083"
    command: ["npx", "@brightdata/mcp"]
    environment:
      - API_TOKEN=${BRIGHTDATA_API_TOKEN}
    restart: unless-stopped

  postgres:
    image: postgres:15
    environment:
      - POSTGRES_DB=tradingview_scanners
      - POSTGRES_USER=tradingview
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./infra/postgres/initdb.d:/docker-entrypoint-initdb.d:ro
    restart: unless-stopped

volumes:
  postgres_data:
```

### 5. JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è MCP –∫–ª–∏–µ–Ω—Ç–∞

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è MCP –∫–ª–∏–µ–Ω—Ç–∞:**

```json
{
  "mcpServers": {
    "Bright Data": {
      "command": "npx",
      "args": ["@brightdata/mcp"],
      "env": {
        "API_TOKEN": "${BRIGHTDATA_API_TOKEN}"
      }
    },
    "tradingview-mcp": {
      "url": "http://127.0.0.1:8060/mcp"
    },
    "binance-mcp-demo": {
      "url": "http://127.0.0.1:8000/mcp"
    },
    "shell-mcp": {
      "url": "http://127.0.0.1:8070/mcp"
    },
    "memory-mcp": {
      "url": "http://127.0.0.1:8050/mcp"
    },
    "backtesting-mcp": {
      "url": "http://127.0.0.1:8082/mcp"
    },
    "supervisor-mcp": {
      "url": "http://127.0.0.1:8001/mcp"
    }
  }
}
```

**–û–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤:**
- **Bright Data**: –í–Ω–µ—à–Ω–∏–π MCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
- **tradingview-mcp**: –ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ —á–µ—Ä–µ–∑ TradingView API
- **binance-mcp-demo**: –î–µ–º–æ-—Ä–µ–∂–∏–º —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ Binance
- **shell-mcp**: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
- **memory-mcp**: –°–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏ –∏ –ø–æ–∏—Å–∫–∞
- **backtesting-mcp**: –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- **supervisor-mcp**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ MCP —Å–µ—Ä–≤–µ—Ä–æ–≤

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 1. API –∫–ª—é—á–∏ –≤ ENV

**‚ùå –ù–ò–ö–û–ì–î–ê:**
- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ API –∫–ª—é—á–∏ –≤ Git
- –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥–µ
- –ù–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**‚úÖ –í–°–ï–ì–î–ê:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –î–æ–±–∞–≤—å—Ç–µ `.env` –≤ `.gitignore`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**–ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**

```python
from pydantic import SecretStr

class Settings(BaseSettings):
    api_key: SecretStr  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏
    api_secret: SecretStr
    
    def get_api_key(self) -> str:
        """Get API key value."""
        return self.api_key.get_secret_value()
```

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–í—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**

```python
from pydantic import BaseModel, validator, Field

class OrderRequest(BaseModel):
    symbol: str = Field(..., regex=r"^[A-Z]{2,10}USDT$")
    side: Literal["buy", "sell"]
    quantity: float = Field(..., gt=0)
    price: float | None = Field(None, gt=0)
    
    @validator("symbol")
    def validate_symbol(cls, v):
        """Validate symbol format."""
        if not v.endswith("USDT"):
            raise ValueError("Only USDT pairs supported")
        return v.upper()
    
    @validator("quantity")
    def validate_quantity(cls, v):
        """Validate quantity is positive."""
        if v <= 0:
            raise ValueError("Quantity must be positive")
        return v
```

### 3. –ò–∑–æ–ª—è—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (Docker)

**Shell MCP –ø–∞—Ç—Ç–µ—Ä–Ω:**

```python
def execute_code(code: str, language: str) -> dict:
    """Execute code in isolated Docker container."""
    container = docker_client.containers.run(
        image=get_image_for_language(language),
        command=["python", "-c", code],
        detach=True,
        mem_limit="512m",       # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
        cpu_quota=50000,        # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ CPU
        network_disabled=False,  # –ö–æ–Ω—Ç—Ä–æ–ª—å —Å–µ—Ç–∏
        remove=True,            # –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ
        read_only=True,         # –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –§–°
        security_opt=["no-new-privileges"],  # –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
    )
    
    try:
        container.wait(timeout=120)
        return {
            "stdout": container.logs(stdout=True).decode(),
            "stderr": container.logs(stderr=True).decode(),
        }
    finally:
        container.remove(force=True)
```

### 4. Rate Limiting

**–ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π:**

```python
from time import time
from collections import defaultdict

class RateLimiter:
    def __init__(self, max_calls: int, period: float):
        self.max_calls = max_calls
        self.period = period
        self.calls = defaultdict(list)
    
    def check_limit(self, key: str) -> bool:
        """Check if rate limit is exceeded."""
        now = time()
        self.calls[key] = [
            t for t in self.calls[key]
            if now - t < self.period
        ]
        
        if len(self.calls[key]) >= self.max_calls:
            return False
        
        self.calls[key].append(now)
        return True

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
limiter = RateLimiter(max_calls=100, period=60.0)

@mcp.tool()
def rate_limited_tool(param: str) -> dict:
    """Tool with rate limiting."""
    if not limiter.check_limit("global"):
        return {"error": "Rate limit exceeded"}
    
    return perform_operation(param)
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**

```python
import logging
import sys

def setup_logging(level: str = "INFO"):
    """Setup structured logging."""
    logging.basicConfig(
        level=getattr(logging, level.upper()),
        format="%(asctime)s | %(name)s | %(levelname)s | %(message)s",
        datefmt="%Y-%m-%d %H:%M:%S",
        handlers=[
            logging.StreamHandler(sys.stdout),
            logging.FileHandler("logs/app.log"),
        ],
    )

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
logger = logging.getLogger(__name__)

@mcp.tool()
def monitored_tool(param: str) -> dict:
    """Tool with structured logging."""
    logger.info(f"Tool called with param={param}")
    
    try:
        result = perform_operation(param)
        logger.info(f"Tool succeeded, result_size={len(result)}")
        return {"success": True, "data": result}
    except Exception as e:
        logger.error(f"Tool failed: {e}", exc_info=True)
        return {"success": False, "error": str(e)}
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (JSON):**

```python
import structlog

structlog.configure(
    processors=[
        structlog.stdlib.add_log_level,
        structlog.stdlib.add_logger_name,
        structlog.processors.TimeStamper(fmt="iso"),
        structlog.processors.JSONRenderer(),
    ]
)

logger = structlog.get_logger()
logger.info("backtest.started", symbol="BTCUSDT", strategy="ma_crossover")
```

### 2. Health Check –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π health check:**

```python
import time
from datetime import datetime

start_time = time.time()

@mcp.tool()
def health(check_dependencies: bool = True) -> dict:
    """Checks the health status of the server and its dependencies."""
    status = {
        "status": "healthy",
        "timestamp": datetime.now().isoformat(),
        "uptime": time.time() - start_time,
        "server_info": {
            "version": "1.0.0",
            "name": "project-mcp",
        },
    }
    
    if check_dependencies:
        dependencies = {}
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        try:
            db.ping()
            dependencies["database"] = {"status": "healthy", "response_time": 0.05}
        except Exception as e:
            dependencies["database"] = {"status": "unhealthy", "error": str(e)}
            status["status"] = "degraded"
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ API
        try:
            response = requests.get(external_api_url, timeout=5)
            dependencies["external_api"] = {
                "status": "healthy" if response.ok else "unhealthy",
                "response_time": response.elapsed.total_seconds(),
            }
        except Exception as e:
            dependencies["external_api"] = {"status": "unhealthy", "error": str(e)}
            status["status"] = "degraded"
        
        status["dependencies"] = dependencies
    
    return status
```

### 3. –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–°–±–æ—Ä –º–µ—Ç—Ä–∏–∫:**

```python
from time import time
from functools import wraps

def track_performance(func):
    """Decorator to track function performance."""
    @wraps(func)
    def wrapper(*args, **kwargs):
        start = time()
        try:
            result = func(*args, **kwargs)
            duration = time() - start
            logger.info(
                f"Function {func.__name__} completed",
                extra={
                    "function": func.__name__,
                    "duration": duration,
                    "success": True,
                }
            )
            return result
        except Exception as e:
            duration = time() - start
            logger.error(
                f"Function {func.__name__} failed",
                extra={
                    "function": func.__name__,
                    "duration": duration,
                    "success": False,
                    "error": str(e),
                }
            )
            raise
    return wrapper

@mcp.tool()
@track_performance
def expensive_operation(param: str) -> dict:
    """Operation with performance tracking."""
    return heavy_computation(param)
```

### 4. –ê–ª–µ—Ä—Ç—ã

**Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**

```python
import requests

class TelegramAlerter:
    def __init__(self, bot_token: str, chat_id: str):
        self.bot_token = bot_token
        self.chat_id = chat_id
        self.api_url = f"https://api.telegram.org/bot{bot_token}/sendMessage"
    
    def send_alert(self, message: str, level: str = "INFO"):
        """Send alert to Telegram."""
        emoji = {"INFO": "‚ÑπÔ∏è", "WARNING": "‚ö†Ô∏è", "ERROR": "üö®"}
        formatted_message = f"{emoji.get(level, '')} {level}: {message}"
        
        try:
            requests.post(
                self.api_url,
                json={"chat_id": self.chat_id, "text": formatted_message},
                timeout=5,
            )
        except Exception as e:
            logger.error(f"Failed to send alert: {e}")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
alerter = TelegramAlerter(
    bot_token=settings.telegram_bot_token,
    chat_id=settings.telegram_chat_id,
)

def critical_operation():
    try:
        result = perform_operation()
    except Exception as e:
        alerter.send_alert(f"Critical operation failed: {e}", level="ERROR")
        raise
```

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### ‚ö†Ô∏è –í–ê–ñ–ù–û: –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π

**–ù–ï –°–û–ó–î–ê–í–ê–ô–¢–ï .md —Ñ–∞–π–ª—ã –æ—Ç—á—ë—Ç—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑!**

‚ùå **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ:**
- –ù–æ–≤—ã–µ .md —Ñ–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–ª–∏ –æ—Ç—á—ë—Ç–∞
- –§–∞–π–ª—ã —Ç–∏–ø–∞ `REPORT_2024.md`, `CHANGES.md`, `UPDATE.md`
- –î—É–±–ª–∏–∫–∞—Ç—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö

‚úÖ **–í–°–ï–ì–î–ê –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã:**

1. **`CHANGELOG.md`** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. **`README.md`** ‚Äî –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –ø—Ä–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
3. **`AGENTS.md`** ‚Äî –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
4. **–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ .md —Ñ–∞–π–ª—ã** ‚Äî –¥–æ–ø–æ–ª–Ω—è–π—Ç–µ, –Ω–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ

### –§–æ—Ä–º–∞—Ç CHANGELOG.md

**–°–ª–µ–¥—É–π—Ç–µ [Keep a Changelog](https://keepachangelog.com/):**

```markdown
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added
- –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### Changed
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

## [1.2.0] - 2025-01-15

### Added
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Optuna –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ù–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `optimize_parameters` —Å TPE sampler

### Changed
- –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞ –Ω–∞ 30%
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏–π

### Fixed
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–º –ø–æ–∏—Å–∫–µ
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ä–∞—Å—á–µ—Ç Sharpe ratio –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø–µ—Ä–∏–æ–¥–æ–≤

### Deprecated
- –ú–µ—Ç–æ–¥ `old_backtest()` –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω –≤ –≤–µ—Ä—Å–∏–∏ 2.0.0

### Removed
- –£–¥–∞–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Python 3.9

### Security
- –û–±–Ω–æ–≤–ª–µ–Ω requests –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è CVE-2024-XXXXX

## [1.1.0] - 2024-12-01

...
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ README.md

**–ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```markdown
# Project Name

Brief description of what this MCP server does.

## Features

- Feature 1
- Feature 2
- Feature 3

## Installation

```bash
# Using pip
pip install -e .

# Using uv
uv sync
```

## Quick Start

```bash
# Stdio mode
python -m project_mcp.server --stdio

# HTTP mode
python -m project_mcp.server --host 0.0.0.0 --port 8000
```

## Configuration

Environment variables:

| Variable | Description | Default |
|----------|-------------|---------|
| `PROJECT_API_KEY` | API key | Required |
| `PROJECT_TIMEOUT` | Request timeout | `30.0` |

## Tools

### tool_name

Description of the tool.

**Parameters:**
- `param1` (string, required): Description
- `param2` (int, optional): Description

**Example:**
```json
{
  "param1": "value",
  "param2": 42
}
```

## Development

```bash
# Tests
pytest tests/

# Linting
ruff check .
black .
mypy .
```

## License

MIT License
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ AGENTS.md

**–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –¥–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤:**

```markdown
# Project MCP Server - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

Brief description and purpose.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project-mcp/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ project_mcp/
‚îÇ       ‚îú‚îÄ‚îÄ server.py
‚îÇ       ‚îú‚îÄ‚îÄ config.py
‚îÇ       ‚îú‚îÄ‚îÄ services/
‚îÇ       ‚îî‚îÄ‚îÄ tools/
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

#### 1. Component Name
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: What it does
- **–§—É–Ω–∫—Ü–∏–∏**: List of functions
- **–ü–∞—Ç—Ç–µ—Ä–Ω—ã**: Design patterns used

## –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 1. –ü—Ä–∏–Ω—Ü–∏–ø
Description and examples

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (Tools)

### –°—Ç–∞–Ω–¥–∞—Ä—Ç –æ–ø–∏—Å–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- Rules for tool descriptions
- Format requirements

### tool_name

**–û–ø–∏—Å–∞–Ω–∏–µ**: What the tool does

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `param` (type, required/optional): Description

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
```json
{
  "result": "value"
}
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
...

### –ó–∞–ø—É—Å–∫
...

## –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞
...

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–º–∏—Ç–æ–≤
...
```

---

## –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ AI –∞–≥–µ–Ω—Ç–æ–≤

### 1. –°–æ–±—ã—Ç–∏–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**Event Bus –ø–∞—Ç—Ç–µ—Ä–Ω:**

```python
from typing import Callable, Any
from collections import defaultdict

class EventBus:
    """Centralized event bus for agent communication."""
    
    def __init__(self):
        self.subscribers: dict[str, list[Callable]] = defaultdict(list)
    
    def subscribe(self, event_type: str, handler: Callable):
        """Subscribe to event type."""
        self.subscribers[event_type].append(handler)
    
    def publish(self, event_type: str, data: Any):
        """Publish event to subscribers."""
        for handler in self.subscribers[event_type]:
            try:
                handler(data)
            except Exception as e:
                logger.error(f"Event handler failed: {e}")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
event_bus = EventBus()

# –ü–æ–¥–ø–∏—Å–∫–∞
event_bus.subscribe("task.completed", on_task_completed)
event_bus.subscribe("error.occurred", on_error)

# –ü—É–±–ª–∏–∫–∞—Ü–∏—è
event_bus.publish("task.completed", {"task_id": "123", "result": "success"})
```

### 2. –°–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏

**–≠–ø–∏–∑–æ–¥–∏—á–µ—Å–∫–∞—è –∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å:**

```python
from dataclasses import dataclass
from datetime import datetime

@dataclass
class MemoryRecord:
    """Memory record structure."""
    record_id: str
    content: str
    source: str
    timestamp: datetime
    tags: list[str]
    metadata: dict
    embedding: list[float] | None = None

class MemorySystem:
    """Unified memory system for AI agents."""
    
    def __init__(self, db_path: str, vector_store_url: str):
        self.graph = TypedGraphMemory(db_path)
        self.vector_store = QdrantVectorStore(vector_store_url)
    
    async def ingest(self, record: MemoryRecord):
        """Ingest memory record."""
        # –î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä–∞—Ñ (FTS)
        await self.graph.add_node(record)
        
        # –î–æ–±–∞–≤–∏—Ç—å –≤–µ–∫—Ç–æ—Ä (ANN)
        if record.embedding:
            await self.vector_store.upsert(record.record_id, record.embedding)
    
    async def search(
        self,
        query: str,
        top_k: int = 10,
        filters: dict | None = None
    ) -> list[MemoryRecord]:
        """Hybrid search: FTS + vector."""
        # FTS –ø–æ–∏—Å–∫
        fts_results = await self.graph.search_text(query, limit=top_k)
        
        # –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫
        vector_results = await self.vector_store.search(
            query_embedding=embed(query),
            limit=top_k
        )
        
        # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        return merge_results(fts_results, vector_results, top_k)
```

### 3. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –æ–±—É—á–µ–Ω–∏–µ

**–ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–∞:**

```python
class AdaptiveAgent:
    """Agent that learns from experience."""
    
    def __init__(self):
        self.experience = []
        self.performance_metrics = {}
    
    def execute_task(self, task: Task) -> Result:
        """Execute task and learn from outcome."""
        start_time = time.time()
        
        try:
            # –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø—ã—Ç–∞
            strategy = self.select_strategy(task)
            
            # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
            result = strategy.execute(task)
            
            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–ø—ã—Ç–∞
            self.record_experience(
                task=task,
                strategy=strategy,
                result=result,
                duration=time.time() - start_time,
                success=True
            )
            
            return result
        
        except Exception as e:
            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ—É–¥–∞—á–Ω–æ–≥–æ –æ–ø—ã—Ç–∞
            self.record_experience(
                task=task,
                strategy=strategy,
                error=str(e),
                duration=time.time() - start_time,
                success=False
            )
            raise
    
    def select_strategy(self, task: Task) -> Strategy:
        """Select best strategy based on past experience."""
        # –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ –æ–ø—ã—Ç–∞
        similar_tasks = self.find_similar_tasks(task)
        
        # –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
        if similar_tasks:
            return self.best_performing_strategy(similar_tasks)
        
        # –î–µ—Ñ–æ–ª—Ç–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–¥–∞—á
        return DefaultStrategy()
```

### 4. –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

**Multi-step –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**

```python
from typing import Protocol

class Step(Protocol):
    """Interface for execution step."""
    def execute(self) -> Any: ...
    def rollback(self) -> None: ...

class Plan:
    """Execution plan with rollback support."""
    
    def __init__(self, steps: list[Step]):
        self.steps = steps
        self.executed_steps: list[Step] = []
    
    async def execute(self) -> Any:
        """Execute plan with automatic rollback on failure."""
        try:
            for step in self.steps:
                logger.info(f"Executing step: {step.__class__.__name__}")
                result = await step.execute()
                self.executed_steps.append(step)
                logger.info(f"Step completed: {step.__class__.__name__}")
            
            return result
        
        except Exception as e:
            logger.error(f"Plan execution failed: {e}")
            await self.rollback()
            raise
    
    async def rollback(self):
        """Rollback executed steps in reverse order."""
        for step in reversed(self.executed_steps):
            try:
                logger.info(f"Rolling back step: {step.__class__.__name__}")
                await step.rollback()
            except Exception as e:
                logger.error(f"Rollback failed for {step.__class__.__name__}: {e}")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
plan = Plan([
    FetchMarketDataStep(),
    AnalyzeDataStep(),
    GenerateSignalsStep(),
    ExecuteTradesStep(),
])

result = await plan.execute()
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Bright Data MCP

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

Bright Data MCP –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º—É –∫–∞–∫ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å —Å–∫—Ä–∞–ø–∏–Ω–≥–∞, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π —á–µ—Ä–µ–∑ `supervisor-mcp`. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –º–æ–≥—É—Ç –¥–µ–ª–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–∫—Ä–∞–ø–∏–Ω–≥ —á–µ—Ä–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   HAL Agent     ‚îÇ‚îÄ‚îÄ‚îÄ‚îê
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
                      ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ TradingView MCP ‚îÇ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚Üí‚îÇ Supervisor MCP   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ    ‚îÇ  (Orchestrator)  ‚îÇ
                      ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ             ‚îÇ
‚îÇ Backtesting MCP ‚îÇ‚îÄ‚îÄ‚îÄ‚îò             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                 ‚îÇ
                                    ‚Üì
                          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                          ‚îÇ Bright Data MCP  ‚îÇ
                          ‚îÇ  (NPX Runtime)   ‚îÇ
                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
                          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                          ‚îÇ   Memory MCP     ‚îÇ
                          ‚îÇ  (Storage)       ‚îÇ
                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2. –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–∫—Ä–∞–ø–∏–Ω–≥–∞

**–ß–µ—Ä–µ–∑ supervisor-mcp –¥–æ—Å—Ç—É–ø–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**

- `scrape_url(url, options)` - —Å–∫—Ä–∞–ø–∏–Ω–≥ –æ–¥–Ω–æ–π URL
- `scrape_urls_batch(urls, options)` - –ø–∞–∫–µ—Ç–Ω—ã–π —Å–∫—Ä–∞–ø–∏–Ω–≥ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö URLs
- `scrape_search_results(query, search_engine, limit, options)` - —Å–∫—Ä–∞–ø–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
- `get_scraping_status(task_id)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏
- `get_scraping_history(limit, status_filter)` - –∏—Å—Ç–æ—Ä–∏—è —Å–∫—Ä–∞–ø–∏–Ω–≥–∞
- `clear_scraping_cache()` - –æ—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞

### 3. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–°–∫—Ä–∞–ø–∏–Ω–≥ –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ–Ω—Ç–∏–º–µ–Ω—Ç–∞:**
```python
# –ß–µ—Ä–µ–∑ supervisor-mcp
result = await supervisor.scrape_url(
    url="https://coinmarketcap.com/currencies/bitcoin/",
    options={"extract": ["price", "volume", "market_cap"]}
)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ memory-mcp
await memory.ingest_scraped_content(
    url=result["url"],
    title=result["title"],
    content=result["content"],
    metadata=result["metadata"]
)
```

**–ü–∞–∫–µ—Ç–Ω—ã–π —Å–∫—Ä–∞–ø–∏–Ω–≥ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤:**
```python
# –°–∫—Ä–∞–ø–∏–Ω–≥ —Ü–µ–Ω —Å —Ä–∞–∑–Ω—ã—Ö –±–∏—Ä–∂
urls = [
    "https://coinmarketcap.com/currencies/bitcoin/",
    "https://coinbase.com/price/bitcoin",
    "https://binance.com/en/price/bitcoin"
]

results = await supervisor.scrape_urls_batch(
    urls=urls,
    options={"extract": ["price", "change_24h"]}
)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
for result in results:
    if result.get("status") != "failed":
        await memory.ingest_scraped_content(
            url=result["url"],
            title=result.get("title", ""),
            content=result["content"],
            metadata=result["metadata"],
            tags=["price_monitoring", "bitcoin"]
        )
```

**–ü–æ–∏—Å–∫ –∏ —Å–∫—Ä–∞–ø–∏–Ω–≥ –Ω–æ–≤–æ—Å—Ç–µ–π:**
```python
# –ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç–µ–π –æ Bitcoin
search_results = await supervisor.scrape_search_results(
    query="bitcoin news today",
    search_engine="google",
    limit=10,
    options={"extract": ["title", "snippet", "url"]}
)

# –°–∫—Ä–∞–ø–∏–Ω–≥ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
for result in search_results:
    if result.get("url"):
        content = await supervisor.scrape_url(
            url=result["url"],
            options={"extract": ["title", "content", "publish_date"]}
        )
        
        await memory.ingest_scraped_content(
            url=content["url"],
            title=content["title"],
            content=content["content"],
            metadata={
                "search_query": "bitcoin news today",
                "search_engine": "google",
                **content["metadata"]
            },
            tags=["news", "bitcoin", "sentiment_analysis"]
        )
```

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç–æ—Ä–≥–æ–≤—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

**–û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è TradingView MCP:**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ –º–æ–Ω–µ—Ç–µ
coin_data = await supervisor.scrape_url(
    url=f"https://coinmarketcap.com/currencies/{symbol.lower()}/",
    options={
        "extract": [
            "market_cap", "volume_24h", "circulating_supply",
            "total_supply", "max_supply", "price_change_24h"
        ]
    }
)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∞–Ω–∞–ª–∏–∑–µ
analysis = await tradingview.coin_analysis(
    symbol=symbol,
    exchange=exchange,
    timeframe=timeframe
)

# –û–±–æ–≥–∞—â–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ —Å–∫—Ä–∞–ø–ª–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
enriched_analysis = {
    **analysis,
    "market_data": coin_data["metadata"],
    "scraped_at": coin_data["timestamp"]
}
```

**–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞:**
```python
# –°–∫—Ä–∞–ø–∏–Ω–≥ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –Ω–æ–≤–æ—Å—Ç–µ–π
historical_news = await supervisor.scrape_search_results(
    query=f"{symbol} news 2024",
    search_engine="google",
    limit=50,
    options={
        "extract": ["title", "snippet", "url", "date"],
        "date_range": "2024-01-01:2024-12-31"
    }
)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å —Ü–µ–Ω–∞–º–∏
for news in historical_news:
    await memory.ingest_scraped_content(
        url=news["url"],
        title=news["title"],
        content=news["snippet"],
        metadata={
            "symbol": symbol,
            "date": news["date"],
            "type": "historical_news"
        },
        tags=["historical", "news", symbol.lower()]
    )
```

### 5. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
```bash
# Bright Data API —Ç–æ–∫–µ–Ω
BRIGHT_DATA_API_TOKEN=your_api_token_here

# URL Bright Data MCP —Å–µ—Ä–≤–µ—Ä–∞
BRIGHT_DATA_MCP_URL=http://bright-data-mcp:8083

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
BRIGHT_DATA_CACHE_TTL=3600  # 1 —á–∞—Å
BRIGHT_DATA_MAX_CONCURRENT=5  # –ú–∞–∫—Å–∏–º—É–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```

**Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```yaml
bright-data-mcp:
  image: node:18-alpine
  container_name: mcp-bright-data-mcp-1
  restart: unless-stopped
  working_dir: /app
  command: ["npx", "-y", "@brightdata/mcp"]
  environment:
    - API_TOKEN=${BRIGHT_DATA_API_TOKEN}
    - PORT=8083
    - NODE_ENV=production
  ports:
    - "8083:8083"
  depends_on:
    redis:
      condition: service_healthy
```

### 6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∫—Ä–∞–ø–∏–Ω–≥–∞:**
```python
# –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å
status = supervisor.get_scraping_status()
print(f"–í—Å–µ–≥–æ –∑–∞–¥–∞—á: {status['total_tasks']}")
print(f"–£—Å–ø–µ—à–Ω—ã—Ö: {status['completed_tasks']}")
print(f"–ù–µ—É–¥–∞—á–Ω—ã—Ö: {status['failed_tasks']}")
print(f"–ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: {status['success_rate']:.2%}")

# –ò—Å—Ç–æ—Ä–∏—è –∑–∞–¥–∞—á
history = supervisor.get_scraping_history(limit=10)
for task in history:
    print(f"–ó–∞–¥–∞—á–∞ {task['task_id']}: {task['status']}")
    if task.get('error'):
        print(f"–û—à–∏–±–∫–∞: {task['error']}")
```

**–û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞:**
```python
# –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ —Å–∫—Ä–∞–ø–∏–Ω–≥–∞
result = supervisor.clear_scraping_cache()
print(f"–û—á–∏—â–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤: {result['cleared_items']}")
```

---

## –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ MCP —Å–µ—Ä–≤–µ—Ä–æ–≤

### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API

**–ü–∞—Ç—Ç–µ—Ä–Ω HTTP –∫–ª–∏–µ–Ω—Ç–∞:**

```python
import httpx
from typing import Any

class ExternalAPIClient:
    """Base client for external API integration."""
    
    def __init__(self, base_url: str, api_key: str, timeout: float = 30.0):
        self.base_url = base_url
        self.api_key = api_key
        self.client = httpx.AsyncClient(
            base_url=base_url,
            timeout=timeout,
            headers={"Authorization": f"Bearer {api_key}"}
        )
    
    async def request(
        self,
        method: str,
        endpoint: str,
        params: dict | None = None,
        json: dict | None = None
    ) -> Any:
        """Make HTTP request with error handling."""
        try:
            response = await self.client.request(
                method=method,
                url=endpoint,
                params=params,
                json=json
            )
            response.raise_for_status()
            return response.json()
        
        except httpx.HTTPStatusError as e:
            logger.error(f"HTTP error {e.response.status_code}: {e}")
            raise APIError(f"API returned {e.response.status_code}")
        
        except httpx.TimeoutException:
            logger.error("Request timeout")
            raise APIError("Request timeout")
        
        except Exception as e:
            logger.exception(f"Unexpected error: {e}")
            raise APIError(f"Unexpected error: {e}")
    
    async def close(self):
        """Close HTTP client."""
        await self.client.aclose()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
client = ExternalAPIClient(
    base_url="https://api.binance.com",
    api_key=settings.binance_api_key
)

async with client:
    data = await client.request("GET", "/api/v3/ticker/price", params={"symbol": "BTCUSDT"})
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤–µ—á–µ–π:**

```python
from dataclasses import dataclass
from datetime import datetime

@dataclass
class Candle:
    """Normalized candle data."""
    timestamp: datetime
    open: float
    high: float
    low: float
    close: float
    volume: float
    
    @classmethod
    def from_binance(cls, data: list) -> "Candle":
        """Parse Binance candle format."""
        return cls(
            timestamp=datetime.fromtimestamp(data[0] / 1000),
            open=float(data[1]),
            high=float(data[2]),
            low=float(data[3]),
            close=float(data[4]),
            volume=float(data[5])
        )
    
    @classmethod
    def from_tradingview(cls, data: dict) -> "Candle":
        """Parse TradingView candle format."""
        return cls(
            timestamp=datetime.fromtimestamp(data["time"]),
            open=data["open"],
            high=data["high"],
            low=data["low"],
            close=data["close"],
            volume=data["volume"]
        )

def normalize_candles(data: list, source: str) -> list[Candle]:
    """Normalize candles from different sources."""
    if source == "binance":
        return [Candle.from_binance(c) for c in data]
    elif source == "tradingview":
        return [Candle.from_tradingview(c) for c in data]
    else:
        raise ValueError(f"Unknown source: {source}")
```

### 3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤:**

```python
from enum import Enum

class OrderSide(str, Enum):
    BUY = "buy"
    SELL = "sell"

class OrderType(str, Enum):
    MARKET = "market"
    LIMIT = "limit"
    STOP_LOSS = "stop_loss"

@dataclass
class Order:
    """Order representation."""
    symbol: str
    side: OrderSide
    order_type: OrderType
    quantity: float
    price: float | None = None
    stop_price: float | None = None

class TradingService:
    """Safe trading operations."""
    
    def __init__(self, client: ExchangeClient, demo_mode: bool = True):
        self.client = client
        self.demo_mode = demo_mode
    
    async def place_order(self, order: Order) -> dict:
        """Place order with validation and safety checks."""
        # –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ä–¥–µ—Ä–∞
        self.validate_order(order)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
        balance = await self.client.get_balance(order.symbol.split("USDT")[0])
        if order.side == OrderSide.SELL and balance < order.quantity:
            raise InsufficientBalanceError(f"Insufficient balance: {balance}")
        
        # –î–µ–º–æ —Ä–µ–∂–∏–º
        if self.demo_mode:
            logger.info(f"[DEMO] Would place order: {order}")
            return {"order_id": "demo_123", "status": "filled"}
        
        # –†–µ–∞–ª—å–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ
        logger.warning(f"[LIVE] Placing order: {order}")
        result = await self.client.place_order(
            symbol=order.symbol,
            side=order.side.value,
            type=order.order_type.value,
            quantity=order.quantity,
            price=order.price,
        )
        
        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        logger.info(f"Order placed: {result['order_id']}")
        
        return result
    
    def validate_order(self, order: Order):
        """Validate order parameters."""
        if order.quantity <= 0:
            raise ValueError("Quantity must be positive")
        
        if order.order_type == OrderType.LIMIT and order.price is None:
            raise ValueError("Limit order requires price")
        
        if order.order_type == OrderType.STOP_LOSS and order.stop_price is None:
            raise ValueError("Stop loss order requires stop_price")
```

### 4. –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

**–ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫:**

```python
@dataclass
class BacktestResult:
    """Backtest result metrics."""
    total_return: float
    annualized_return: float
    sharpe_ratio: float
    max_drawdown: float
    win_rate: float
    profit_factor: float
    total_trades: int
    equity_curve: list[float]
    trades: list[dict]

class Strategy(Protocol):
    """Strategy interface."""
    def on_candle(self, candle: Candle) -> Signal | None: ...
    def on_trade_closed(self, trade: Trade): ...

class BacktestEngine:
    """Backtesting engine."""
    
    def __init__(self, initial_capital: float = 10000):
        self.initial_capital = initial_capital
        self.capital = initial_capital
        self.equity_curve = [initial_capital]
        self.trades = []
        self.position = None
    
    def run(
        self,
        strategy: Strategy,
        candles: list[Candle],
        commission: float = 0.001
    ) -> BacktestResult:
        """Run backtest."""
        for candle in candles:
            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞
            signal = strategy.on_candle(candle)
            
            # –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
            if signal and not self.position:
                self.position = self.open_position(candle, signal)
            
            # –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
            elif self.position and self.should_close(candle, self.position):
                trade = self.close_position(candle, commission)
                self.trades.append(trade)
                strategy.on_trade_closed(trade)
            
            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ equity
            equity = self.calculate_equity(candle)
            self.equity_curve.append(equity)
        
        return self.calculate_metrics()
    
    def calculate_metrics(self) -> BacktestResult:
        """Calculate performance metrics."""
        total_return = (self.capital - self.initial_capital) / self.initial_capital
        
        winning_trades = [t for t in self.trades if t["pnl"] > 0]
        losing_trades = [t for t in self.trades if t["pnl"] <= 0]
        
        win_rate = len(winning_trades) / len(self.trades) if self.trades else 0
        
        gross_profit = sum(t["pnl"] for t in winning_trades)
        gross_loss = abs(sum(t["pnl"] for t in losing_trades))
        profit_factor = gross_profit / gross_loss if gross_loss > 0 else 0
        
        sharpe_ratio = self.calculate_sharpe()
        max_drawdown = self.calculate_max_drawdown()
        
        return BacktestResult(
            total_return=total_return,
            annualized_return=self.annualize_return(total_return),
            sharpe_ratio=sharpe_ratio,
            max_drawdown=max_drawdown,
            win_rate=win_rate,
            profit_factor=profit_factor,
            total_trades=len(self.trades),
            equity_curve=self.equity_curve,
            trades=self.trades
        )
```

---

## –®–∞–±–ª–æ–Ω—ã –∏ –ø—Ä–∏–º–µ—Ä—ã

### 1. –®–∞–±–ª–æ–Ω —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π MCP —Å–µ—Ä–≤–µ—Ä:**

```
servers/project-mcp/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ project_mcp/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ server.py           # FastMCP —Å–µ—Ä–≤–µ—Ä
‚îÇ       ‚îú‚îÄ‚îÄ config.py           # Pydantic Settings
‚îÇ       ‚îú‚îÄ‚îÄ services/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ core.py         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ       ‚îî‚îÄ‚îÄ tools/
‚îÇ           ‚îú‚îÄ‚îÄ __init__.py
‚îÇ           ‚îú‚îÄ‚îÄ models.py       # Pydantic –º–æ–¥–µ–ª–∏
‚îÇ           ‚îî‚îÄ‚îÄ handlers.py     # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py
‚îÇ   ‚îú‚îÄ‚îÄ test_services/
‚îÇ   ‚îî‚îÄ‚îÄ test_tools/
‚îú‚îÄ‚îÄ examples/
‚îÇ   ‚îî‚îÄ‚îÄ example_usage.py
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ api.md
‚îú‚îÄ‚îÄ pyproject.toml
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ AGENTS.md
‚îú‚îÄ‚îÄ CHANGELOG.md
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ .gitignore
```

### 2. –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

**–ë–∞–∑–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:**

```python
from fastmcp import FastMCP
from pydantic import BaseModel, Field

mcp = FastMCP("example-server")

class ExampleRequest(BaseModel):
    """Request model."""
    param: str = Field(..., description="Parameter description")
    limit: int = Field(default=10, ge=1, le=100)

@mcp.tool()
def example_tool(request: ExampleRequest) -> dict:
    """Performs an example operation with validation."""
    result = service.process(request.param, request.limit)
    return {
        "success": True,
        "data": result,
        "metadata": {
            "param": request.param,
            "limit": request.limit
        }
    }
```

**Health check:**

```python
import time

start_time = time.time()

@mcp.tool()
def health() -> dict:
    """Checks server health status."""
    return {
        "status": "healthy",
        "uptime": time.time() - start_time,
        "version": "1.0.0"
    }
```

**Version info:**

```python
@mcp.tool()
def version() -> dict:
    """Returns server version and configuration."""
    return {
        "version": "1.0.0",
        "name": "example-mcp",
        "config": {
            "timeout": settings.timeout,
            "max_retries": settings.max_retries
        },
        "features": [
            "feature_1",
            "feature_2"
        ]
    }
```

### 3. –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**pyproject.toml:**

```toml
[project]
name = "project-mcp"
version = "1.0.0"
description = "MCP server for X"
authors = [{name = "Your Name", email = "you@example.com"}]
requires-python = ">=3.11"
dependencies = [
    "fastmcp>=0.1.0",
    "pydantic>=2.0.0",
    "pydantic-settings>=2.0.0",
    "httpx>=0.24.0",
]

[project.optional-dependencies]
dev = [
    "pytest>=7.0.0",
    "pytest-asyncio>=0.21.0",
    "pytest-cov>=4.0.0",
    "black>=23.0.0",
    "ruff>=0.1.0",
    "mypy>=1.0.0",
]

[project.scripts]
project-mcp = "project_mcp.server:main"

[tool.black]
line-length = 88
target-version = ['py311']

[tool.ruff]
line-length = 88
select = ["E", "F", "I", "N", "W"]

[tool.mypy]
python_version = "3.11"
strict = true

[tool.pytest.ini_options]
testpaths = ["tests"]
asyncio_mode = "auto"

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"
```

**.env.example:**

```bash
# API Configuration
PROJECT_API_KEY=your_api_key_here
PROJECT_API_SECRET=your_api_secret_here

# Server Configuration
PROJECT_HOST=0.0.0.0
PROJECT_PORT=8000
PROJECT_DEBUG=false

# Timeouts and Limits
PROJECT_TIMEOUT=30.0
PROJECT_MAX_RETRIES=3
PROJECT_RATE_LIMIT=100

# Logging
PROJECT_LOG_LEVEL=INFO
```

**Dockerfile:**

```dockerfile
FROM python:3.11-slim

WORKDIR /app

# Install dependencies
COPY pyproject.toml .
RUN pip install --no-cache-dir -e .

# Copy application
COPY src/ src/

# Expose port
EXPOSE 8000

# Run server
CMD ["python", "-m", "project_mcp.server", "--host", "0.0.0.0", "--port", "8000"]
```

### 4. –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤

**–ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç:**

```python
import pytest
from project_mcp.services import CoreService

@pytest.fixture
def service():
    """Service fixture."""
    return CoreService()

def test_service_processes_data(service):
    """Test that service processes data correctly."""
    result = service.process("test", 10)
    
    assert result is not None
    assert len(result) <= 10
    assert all(isinstance(item, dict) for item in result)
```

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç:**

```python
import pytest

@pytest.mark.asyncio
async def test_async_operation():
    """Test async operation."""
    result = await async_service.fetch_data("param")
    assert result["status"] == "success"
```

**MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ç–µ—Å—Ç:**

```python
from fastmcp.testing import MCPTestClient

@pytest.mark.asyncio
async def test_mcp_tool():
    """Test MCP tool through client."""
    async with MCPTestClient(mcp) as client:
        response = await client.call_tool(
            "example_tool",
            {"param": "value", "limit": 5}
        )
        
        assert response["success"] is True
        assert "data" in response
        assert len(response["data"]) <= 5
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –∂–∏–≤—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –∏ –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –ø–æ –º–µ—Ä–µ —Ä–∞–∑–≤–∏—Ç–∏—è —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã MCP.

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**

1. **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ**: –í—Å–µ MCP —Å–µ—Ä–≤–µ—Ä—ã —Å–ª–µ–¥—É—é—Ç –æ–¥–Ω–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º
2. **–ö–∞—á–µ—Å—Ç–≤–æ**: –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–¥—É –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –∏ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:**

- –°–æ–∑–¥–∞–≤–∞–π—Ç–µ issues –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –û–±–Ω–æ–≤–ª—è–π—Ç–µ AGENTS.md –≤ —Å–≤–æ–µ–º –ø—Ä–æ–µ–∫—Ç–µ
- –°–ª–µ–¥—É–π—Ç–µ Conventional Commits
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ CHANGELOG.md –∞–∫—Ç—É–∞–ª—å–Ω—ã–º

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 7 –Ω–æ—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä—ã:** HAL Team

