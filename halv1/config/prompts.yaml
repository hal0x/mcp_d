# prompts.yaml - Конфигурация промтов для HAL AI-агента

# Настройки системы
system:
  max_tokens: 32000
  update_frequency: "weekly"  # daily, weekly, monthly
  default_language: "ru"

# Системные промты
system_prompts:
  base_role: |
    Роль: Ты — HAL, интеллектуальный AI-помощник с доступом к многоуровневой памяти пользователя.
    Твоя задача: анализировать контекст жизни пользователя, искать релевантную информацию и выполнять задачи.
    
    Профиль пользователя: {user_name}
    Текущее время: {current_time}
    Таймзона: {timezone}
    
    Твои возможности:
    - Анализ событий, тем и эмоций из памяти пользователя
    - Поиск актуальной информации в интернете
    - Генерация и выполнение кода для решения задач
    - Планирование многошаговых задач
    - Адаптация под предпочтения пользователя
  
  coordinator: |
    Проанализируй запрос пользователя и определи стратегию ответа.
    
    Запрос: {user_query}
    Контекст пользователя: {user_context}
    
    Доступные модули:
    - events: анализ событий, дедлайнов, встреч, временных паттернов
    - themes: работа с темами, проектами, интересами, накопленными знаниями
    - emotions: понимание настроения, стресс-факторов, эмоциональных паттернов
    
    Доступные инструменты: {available_tools}
    
    Верни план действий в JSON формате:
    {{
      "strategy": "краткое описание подхода",
      "modules": ["список модулей для использования"],
      "tools": ["список инструментов"],
      "memory_levels": ["уровни памяти для анализа"],
      "expected_output": "ожидаемый результат"
    }}

# Модульные промты
module_prompts:
  events:
    short_term: |
      Анализ краткосрочных событий HAL.
      
      ДАННЫЕ: {short_term_memory}
      ВРЕМЯ: {current_time}
      
      ЗАДАЧА: Приоритизируй события из памяти.
      
      АНАЛИЗИРУЙ:
      1. Дедлайны и встречи
      2. Срочные задачи
      3. Недавние события (24-48 часов)
      
      ФОРМАТ:
      **КРИТИЧНО:** [событие] - [время]
      **ВАЖНО:** [событие] - [время]
      **ОБЫЧНО:** [событие] - [время]
      
      Если данных нет: "Нет данных о краткосрочных событиях"
    
    long_term: |
      Анализ долгосрочных событий.
      
      Данные: {long_term_memory}
      
      Выдели:
      - Исторические паттерны
      - Важные события
      - Повторяющиеся события
      - Долгосрочные тренды
      
      Формат: анализ паттернов с выводами.
    
    episodic: |
      Анализ конкретных эпизодов.
      
      Данные: {episodic_memory}
      Контекст: {query_context}
      
      Выдели:
      - Конкретные случаи и уроки
      - Успешные решения
      - Ошибки и решения
      - Релевантные примеры
      
      Формат: примеры с анализом.

  themes:
    short_term: |
      Анализ активных тем и проектов.
      
      Данные: {short_term_memory}
      
      Выдели:
      - Активные проекты
      - Рабочие темы
      - Интересы и хобби
      - Текущие проблемы
      
      Формат: список тем с приоритетами.
    
    long_term: |
      Анализ накопленных знаний по темам.
      
      Данные: {long_term_memory}
      
      Выдели:
      - Экспертизу и знания
      - Тематические паттерны
      - Долгосрочные интересы
      - Связи между темами
      
      Формат: тематический анализ с выводами.
    
    episodic: |
      Проанализируй конкретные обсуждения и инсайты по темам.
      
      Данные: {episodic_memory}
      Контекст запроса: {query_context}
      
      Выдели и структурируй:
      - Важные обсуждения и их результаты
      - Инсайты и открытия
      - Решения проблем по темам
      - Релевантные примеры для текущего запроса
      
      Формат ответа: конкретные примеры с анализом и выводами.

  emotions:
    short_term: |
      Проанализируй текущее эмоциональное состояние пользователя.
      
      Данные: {short_term_memory}
      Текущее время: {current_time}
      
      Выдели и структурируй:
      - Текущее настроение и эмоции
      - Активные стресс-факторы
      - Эмоциональные триггеры
      - Уровень энергии и мотивации
      
      Формат ответа: анализ эмоционального состояния с рекомендациями.
    
    long_term: |
      Проанализируй эмоциональные паттерны пользователя.
      
      Данные: {long_term_memory}
      
      Выдели и структурируй:
      - Повторяющиеся эмоциональные паттерны
      - Триггеры и их влияние
      - Эмоциональные циклы и сезонность
      - Связи между событиями и эмоциями
      
      Формат ответа: анализ паттернов с выводами и рекомендациями.
    
    episodic: |
      Проанализируй конкретные эмоциональные моменты пользователя.
      
      Данные: {episodic_memory}
      Контекст запроса: {query_context}
      
      Выдели и структурируй:
      - Важные эмоциональные события
      - Реакции на разные ситуации
      - Эмоциональные уроки и инсайты
      - Релевантные примеры для текущего запроса
      
      Формат ответа: конкретные примеры с анализом эмоциональных реакций.

# Промты инструментов
tool_prompts:
  search:
    web_search: |
      Найди актуальную информацию в интернете по запросу пользователя.
      
      Запрос: {query}
      Контекст пользователя: {user_context}
      Приоритетные темы: {priority_themes}
      
      Требования:
      - Ищи только релевантную и актуальную информацию
      - Учитывай контекст и интересы пользователя
      - Проверяй достоверность источников
      - Выделяй ключевые факты и инсайты
      
      Формат ответа: структурированная информация с источниками и оценкой достоверности.
  
  code:
    generation: |
      Создай код для решения задачи пользователя.
      
      Задача: {task_description}
      Контекст: {user_context}
      Доступные данные: {available_data}
      Требования: {code_requirements}
      
      Критически важные требования:
      1. Пиши ТОЛЬКО корректный Python код без синтаксических ошибок
      2. НЕ используй специальные символы: →, –, —, ', ', ", " и другие Unicode
      3. Используй только стандартные ASCII символы: -, +, *, /, =, ', "
      4. Всегда тестируй синтаксис в уме перед ответом
      5. Добавляй print() для вывода результата
      6. Используй только простые операции и стандартные библиотеки
      7. НЕ оборачивай в markdown блоки ```python``` - только чистый код
      8. Язык вывода: используй ТОТ ЖЕ язык, что и в описании задачи
      9. ВСЕГДА добавляй необходимые импорты в начало кода (например: from datetime import datetime, date; import platform)
      10. Если используешь функции из модулей, обязательно импортируй их
      
      Формат ответа: только чистый Python код без дополнительных комментариев.
    
    execution: |
      Выполни код и проанализируй результат.
      
      Код: {code}
      Ожидаемый результат: {expected_output}
      Контекст: {user_context}
      
      Проанализируй:
      - Корректность выполнения
      - Соответствие ожидаемому результату
      - Возможные ошибки или проблемы
      - Рекомендации по улучшению
      
      Формат ответа: результат выполнения с анализом и рекомендациями.

  planning:
    task_plan: |
      Создай детальный план выполнения задачи.
      
      Задача: {task}
      Доступные инструменты: {available_tools}
      Контекст пользователя: {user_context}
      Приоритеты: {priorities}
      
      Верни план в JSON формате:
      {{
        "strategy": "общая стратегия выполнения",
        "steps": [
          {{
            "id": "уникальный идентификатор",
            "tool": "инструмент для выполнения",
            "content": "описание действия",
            "expected_output": "ожидаемый результат",
            "is_final": false,
            "depends_on": ["список зависимостей"]
          }}
        ],
        "completion_criteria": "критерии завершения задачи",
        "estimated_time": "оценка времени выполнения"
      }}

# Промты адаптации
adaptation_prompts:
  learning: |
    Проанализируй взаимодействия с пользователем за период и извлеки уроки.
    
    Период: {period}
    Данные взаимодействий: {interaction_data}
    Реакции пользователя: {user_reactions}
    Метрики производительности: {performance_metrics}
    
    Проанализируй:
    - Паттерны предпочтений пользователя
    - Эффективные стратегии ответов
    - Проблемные области и ошибки
    - Возможности для улучшения
    
    Предложи конкретные изменения в:
    - Стиле общения
    - Выборе инструментов
    - Приоритизации информации
    - Формате ответов
    
    Формат ответа: структурированный анализ с конкретными рекомендациями.
  
  self_analysis: |
    Проведи самоанализ работы агента и предложи улучшения.
    
    Метрики производительности: {performance_metrics}
    Ошибки и проблемы: {errors}
    Успехи и достижения: {successes}
    Обратная связь пользователя: {user_feedback}
    
    Проанализируй:
    - Эффективность текущих промтов
    - Качество планирования и выполнения задач
    - Точность анализа контекста
    - Удовлетворенность пользователя
    
    Предложи улучшения в:
    - Промтах и их структуре
    - Алгоритмах принятия решений
    - Обработке ошибок
    - Адаптации к пользователю
    
    Формат ответа: детальный анализ с конкретными предложениями по улучшению.

# Настройки модулей
module_settings:
  events:
    priority: 1
    memory_levels: ["short_term", "long_term", "episodic"]
    update_frequency: "daily"
    max_context_length: 2000
  
  themes:
    priority: 2
    memory_levels: ["short_term", "long_term", "episodic"]
    update_frequency: "weekly"
    max_context_length: 3000
  
  emotions:
    priority: 3
    memory_levels: ["short_term", "long_term", "episodic"]
    update_frequency: "daily"
    max_context_length: 1500

# Настройки инструментов
tool_settings:
  search:
    max_results: 5
    timeout: 30
    cache_ttl: 3600
    max_context_length: 1000
  
  code:
    max_attempts: 3
    timeout: 60
    safety_checks: true
    max_code_length: 5000
  
  planning:
    max_steps: 10
    timeout: 30
    fallback_enabled: true
    max_plan_length: 2000

# Настройки памяти
memory_settings:
  short_term:
    max_entries: 100
    ttl_hours: 24
    priority_threshold: 0.7
  
  long_term:
    max_entries: 1000
    compression_threshold: 0.8
    summary_length: 200
  
  episodic:
    max_entries: 500
    ttl_days: 30
    importance_threshold: 0.6
