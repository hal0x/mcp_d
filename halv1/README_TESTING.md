# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã —Ä–∞–±–æ—Ç—ã Telegram –±–æ—Ç–∞.

## –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã

### 1. –û—Ç–ª–∞–¥–æ—á–Ω—ã–π —Ç–µ—Å—Ç (–±–µ–∑ LLM)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–∑–æ–≤—É—é —Ä–∞–±–æ—Ç—É Event Bus:
```bash
python test_bot_debug.py
```

### 2. –†–µ–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç (—Å LLM)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É —Å LLM –∫–ª–∏–µ–Ω—Ç–æ–º:
```bash
python test_bot_real.py
```

### 3. –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (–ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É —Å –ø–æ–ª–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π:
```bash
python test_bot_quick.py
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### –ü—Ä–æ—Å—Ç—ã–µ —Ç–µ—Å—Ç—ã
```bash
python tests/run_bot_tests.py --simple
```

### –ü–æ–ª–Ω—ã–µ —Ç–µ—Å—Ç—ã
```bash
python tests/run_bot_tests.py --full
```

### –í—Å–µ —Ç–µ—Å—Ç—ã
```bash
python tests/run_bot_tests.py
```

## –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

### 1. Event Bus
- ‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### 2. LLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ LLM –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
- ‚ùå Ollama API (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

### 3. –ü–∞–º—è—Ç—å –∞–≥–µ–Ω—Ç–∞
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚úÖ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫

### 4. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. Ollama API –æ—à–∏–±–∫–∞ 404
**–ü—Ä–æ–±–ª–µ–º–∞**: `404 Client Error: Not Found for url: http://localhost:11434/v1/chat/completions`

**–†–µ—à–µ–Ω–∏–µ**: Ollama –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥—Ä—É–≥–æ–π API endpoint. –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ `llm/ollama_client.py`:
```python
# –í–º–µ—Å—Ç–æ /v1/chat/completions –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å /api/chat
```

### 2. Event Bus –æ—à–∏–±–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: `event_failed` –≤ –ª–æ–≥–∞—Ö

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏ –∏—Ö –ø–æ–¥–ø–∏—Å–∫–∏

### 3. –ü–∞–º—è—Ç—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–ü—Ä–æ–±–ª–µ–º–∞**: –ó–∞–ø—Ä–æ—Å—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–∞–º—è—Ç–∏

**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `semantic_search` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ `_handle_simple_query`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îú‚îÄ‚îÄ test_bot_simple.py      # –ü—Ä–æ—Å—Ç—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ test_bot_queries.py     # –ü–æ–ª–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ README_BOT_TESTS.md     # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ run_bot_tests.py            # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îî‚îÄ‚îÄ README_TESTING.md           # –≠—Ç–æ—Ç —Ñ–∞–π–ª

# –ö–æ—Ä–Ω–µ–≤—ã–µ —Ç–µ—Å—Ç—ã
test_bot_debug.py               # –û—Ç–ª–∞–¥–æ—á–Ω—ã–π —Ç–µ—Å—Ç
test_bot_real.py                # –†–µ–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç
test_bot_quick.py               # –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
```

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

### 1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–µ—Å—Ç
```python
# tests/integration/test_my_feature.py
import pytest
from events.models import MessageReceived, ReplyReady

class TestMyFeature:
    @pytest.mark.asyncio
    async def test_my_feature(self, simple_bot):
        """–¢–µ—Å—Ç –º–æ–µ–π —Ñ—É–Ω–∫—Ü–∏–∏."""
        replies = await simple_bot.send_message("—Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ")
        assert len(replies) > 0
        assert "–æ–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç" in replies[0].reply
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç
```bash
python -m pytest tests/integration/test_my_feature.py -v -s
```

## –û—Ç–ª–∞–¥–∫–∞

### 1. –í–∫–ª—é—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏
```bash
export LOGLEVEL=DEBUG
python test_bot_debug.py
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Ollama
```bash
curl http://localhost:11434/api/tags
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Docker
```bash
docker --version
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip list | grep -E "(ollama|telegram|asyncio)"
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
- Event Bus
- –ü–∞–º—è—Ç—å –∞–≥–µ–Ω—Ç–∞
- –ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—á–∞—Å—Ç–∏—á–Ω–æ)

### ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- Ollama API (404 –æ—à–∏–±–∫–∞)
- –°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (event_failed)
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–∞–º—è—Ç–∏ –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö

### üîß –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- LLM –∫–ª–∏–µ–Ω—Ç –¥–ª—è Ollama
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –≤ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å Ollama API endpoint
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø–∞–º—è—Ç–∏
4. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞
5. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
