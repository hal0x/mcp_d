## MCP –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

HALv1 —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã MCP (Model Context Protocol) –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ MCP —Å–µ—Ä–≤–µ—Ä–∞–º–∏:

### –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ MCP —Å–µ—Ä–≤–µ—Ä—ã
- **Memory MCP** - —Å–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏ –∏ –ø–æ–∏—Å–∫–∞ (–∑–∞–º–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –º–æ–¥—É–ª—è –ø–∞–º—è—Ç–∏)
- **TradingView MCP** - –∞–Ω–∞–ª–∏–∑ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞
- **Binance MCP** - –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **Backtesting MCP** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- **Shell MCP** - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ
- **Supervisor MCP** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ MCP —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- **Learning MCP** - —Å–∏—Å—Ç–µ–º–∞ –æ–±—É—á–µ–Ω–∏—è –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
- **Policy MCP** - –ø–æ–ª–∏—Ç–∏–∫–∏ –∏ –ø—Ä–æ—Ñ–∏–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Orchestrator MCP** - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∑–∞–¥–∞—á –º–µ–∂–¥—É MCP —Å–µ—Ä–≤–µ—Ä–∞–º–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **MCPMemoryAdapter** - –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Memory MCP —Å —Å–∏—Å—Ç–µ–º–æ–π –ø–∞–º—è—Ç–∏ HALv1
- **MCP Integration Layer** - —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ª–æ–π –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å MCP —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- **Event Bus** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **Supervisor MCP** - –µ–¥–∏–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –∏ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å –∑–∞ –≤—Å–µ–º–∏ MCP —Å–µ—Ä–≤–µ—Ä–∞–º–∏

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ [memory/MCP_INTEGRATION.md](memory/MCP_INTEGRATION.md) –∏ [MCP_ECOSYSTEM_GUIDELINES.md](../../MCP_ECOSYSTEM_GUIDELINES.md)

## –ï–¥–∏–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –ø—Ä–æ–º–ø—Ç–æ–≤
- –í—Å–µ –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–º–ø—Ç—ã —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `llm/prompts.py`:
  - `make_web_summary_prompt()` ‚Äî —Å–≤–æ–¥–∫–∞ –Ω–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –≤–µ–±‚Äë–∫–æ–Ω—Ç–µ–Ω—Ç–∞
  - `make_agent_summary_prompt()` ‚Äî –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–≤–æ–¥–∫–∏/–∞–ª–µ—Ä—Ç—ã Telegram‚Äë–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
  - `make_code_prompt()` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Python‚Äë–∫–æ–¥–∞ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤: `internet/search_client.py`, `index/summarizer.py`, `executor/code_generator.py`.

## –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø—Ä–∞–≤–æ–∫
- –û–±–Ω–æ–≤–ª—è–π—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è
- –ù–µ –¥—É–±–ª–∏—Ä—É–π—Ç–µ —Å–≤–µ–¥–µ–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö .md ‚Äî —Å—Å—ã–ª–∫–∞ —Å—é–¥–∞

–°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã):
- [tests/run_integration_tests.py](../tests/run_integration_tests.py) ‚Äî –∑–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- [security/policy_engine.py](../security/policy_engine.py) ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –ü–æ–ª–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- **–ò–Ω–¥–µ–∫—Å**: [INDEX.md](INDEX.md) - —ç—Ç–æ—Ç —Ñ–∞–π–ª
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: [ARCHITECTURE.md](ARCHITECTURE.md) - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π**: [IMPROVEMENT_PLAN.md](IMPROVEMENT_PLAN.md) - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ roadmap —Ä–∞–∑–≤–∏—Ç–∏—è
- **–ü–æ–ª–∏—Ç–∏–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**: [../AGENTS.md](../AGENTS.md) - —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- **MCP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: [memory/MCP_INTEGRATION.md](memory/MCP_INTEGRATION.md) - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MCP —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- **–¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥—Ä–∞—Ñ-–ø–∞–º—è—Ç—å**: [memory/MEMORY2_Typed_Graph_Memory.md](memory/MEMORY2_Typed_Graph_Memory.md) - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–º—è—Ç–∏
- **–ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏**: [memory/MEMORY_MIGRATION_PLAN.md](memory/MEMORY_MIGRATION_PLAN.md) - –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ —Å MemoryStore
- **UX –¥–∏–∑–∞–π–Ω**: [UX_DESIGN.md](UX_DESIGN.md) - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

### –ê—Ä—Ö–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –∞–ª–µ—Ä—Ç—ã**: [done/INTERACTIVE_TRADING_ALERTS.md](done/INTERACTIVE_TRADING_ALERTS.md) - –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –í–Ω–µ—à–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- **MCP Ecosystem Guidelines**: [../../MCP_ECOSYSTEM_GUIDELINES.md](../../MCP_ECOSYSTEM_GUIDELINES.md) - –æ–±—â–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã MCP —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã
- **–ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è HAL**: [../../impl_plan/hal_ai_agent_plan.md](../../impl_plan/hal_ai_agent_plan.md) - –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –∞–≥–µ–Ω—Ç–∞

## –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Docker executor (`executor.provider: "docker"`).
- –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å `@pydantic/mcp-run-python` –¥–æ–±–∞–≤–ª–µ–Ω MCP executor.
- –í `config/settings.yaml` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `executor.provider: "mcp"` –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ –±–ª–æ–∫ `executor.mcp` (stdio —á–µ—Ä–µ–∑ `deno` –∏–ª–∏ SSE-—ç–Ω–¥–ø–æ–∏–Ω—Ç Glama).
- –ü–∞—Ä–∞–º–µ—Ç—Ä `extra_arguments` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–∫–∏–¥—ã–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤) –≤ MCP tool.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

–°–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å –ø–æ–ª—è–º–∏:

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
- `id` - ID —Å–æ–æ–±—â–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∞)
- `date_utc` - –¥–∞—Ç–∞ –≤ UTC ISO8601 —Ñ–æ—Ä–º–∞—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "2025-09-28T07:12:33Z")
- `from` - –æ–±—ä–µ–∫—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ:
  - `id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–∫–∞–Ω–∞–ª–∞
  - `username` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
  - `display` - –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è
- `text` - —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- `reply_to` - ID —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–≤–µ—á–∞—é—Ç (null –µ—Å–ª–∏ –Ω–µ—Ç)
- `reactions` - –º–∞—Å—Å–∏–≤ —Ä–µ–∞–∫—Ü–∏–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ `[{"emoji":"üëç","count":2}, ...]`
- `attachments` - –º–∞—Å—Å–∏–≤ –≤–ª–æ–∂–µ–Ω–∏–π:
  - `{type: "photo", file: "photo_123.jpg"}`
  - `{type: "document", file: "doc_123.pdf"}`
  - `{type: "url", href: "https://example.com"}`
  - `{type: "voice", file: "voice_123.ogg"}`
  - `{type: "sticker", file: "sticker_123.webp"}`
- `forwarded_from` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–µ—Ä–µ—Å—ã–ª–∫–µ (null –µ—Å–ª–∏ –Ω–µ—Ç)
- `language` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —è–∑—ã–∫ —Å–æ–æ–±—â–µ–Ω–∏—è ("ru", "en" –∏–ª–∏ null)
- `chat` - –Ω–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- `edited_utc` - –¥–∞—Ç–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ UTC ISO8601 (null –µ—Å–ª–∏ –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å)

### –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```json
{
  "id": "123456789",
  "date_utc": "2025-09-28T07:12:33Z",
  "from": { 
    "id": 111, 
    "username": "alice", 
    "display": "Alice" 
  },
  "text": "–ì–æ—Ç–æ–≤–æ, –≤—ã–∫–∞—Ç–∏–ª–∞ –∞–ª–µ—Ä—Ç—ã –ø–æ SOL",
  "reply_to": "123456700",
  "reactions": [ 
    { "emoji": "üëç", "count": 2 }, 
    { "emoji": "üî•", "count": 1 } 
  ],
  "attachments": [
    { "type": "photo", "file": "IMG_001.jpg" },
    { "type": "url", "href": "https://coinglass.com/..." }
  ],
  "forwarded_from": null,
  "language": "ru",
  "chat": "Trading Chat"
}
```
